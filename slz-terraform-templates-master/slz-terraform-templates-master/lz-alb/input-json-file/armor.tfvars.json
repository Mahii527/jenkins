{
    "armor": [
         {
             "security_policy_name": "qa-svc-https-lb-security-policy",
             "project_id": "reference-service-prj",
             "security_policy_type": "CLOUD_ARMOR_EDGE",
             "security_policy_description": "Cloud Armor Policies for HTTPS LB",
             "security_policy_default_rules": {
                 "def_rule": {
                     "action": "deny(403)",
                     "priority": "2147483647",
                     "versioned_expr": "SRC_IPS_V1",
                     "src_ip_ranges": ["*"],
                     "description": "Default rule",
                     "preview": false
                 }
             },
             "security_policy_throttle_rules": {},
             "security_policy_countries_rules": {
                 "allow_rule": {
                     "action": "allow",
                     "priority": "100",
                     "expression": "'[US]'.contains(origin.region_code)",
                     "description": "Allow US Traffic",
                     "preview": false
                 },
 
                 "deny_rule": {
                     "action": "deny(403)",
                     "priority": "200",
                     "expression": "'[CU, KP, SY, IQ]'.contains(origin.region_code)",
                     "description": "Deny access to Cuba, North Korea, Syria & Iraq",
                     "preview": false
                 }    
             },
             "security_policy_owasp_rules": {},
             "security_policy_cves_and_vulnerabilities_rules": {}
         },
         {
             "security_policy_name": "qa-svc-gke-security-policy",
             "project_id": "reference-service-prj",
             "security_policy_type": "CLOUD_ARMOR",
             "security_policy_description": "Cloud Armor Policies for GKE",
             "security_policy_default_rules": {
                 "def_rule": {
                     "action": "deny(403)",
                     "priority": "2147483647",
                     "versioned_expr": "SRC_IPS_V1",
                     "src_ip_ranges": ["*"],
                     "description": "Default rule",
                     "preview": false
                 }
             },
             "security_policy_throttle_rules": {
                "def_rule": {
                    "action": "throttle",
                    "priority": "400",
                    "versioned_expr": "SRC_IPS_V1",
                    "src_ip_ranges": ["*"],
                    "description": "Throttling traffic rule",
                    "conform_action": "allow",
                    "exceed_action": "deny(429)",
                    "enforce_on_key": "ALL", 
                    "rate_limit_threshold_count": "100",
                    "rate_limit_threshold_interval_sec": "60",
                    "preview": false
                }
             },
             "security_policy_countries_rules": {
                 "allow_rule": {
                     "action": "allow",
                     "priority": "100",
                     "expression": "'[US]'.contains(origin.region_code)",
                     "description": "Allow US Traffic",
                     "preview": false
                 },
 
                 "deny_rule": {
                     "action": "deny(403)",
                     "priority": "200",
                     "expression": "'[CU, KP, SY, IQ]'.contains(origin.region_code)",
                     "description": "Deny access to Cuba, North Korea, Syria & Iraq",
                     "preview": false
                 }    
             },
             "security_policy_owasp_rules": {
                 "rule_sqli": {
                     "action": "deny(403)",
                     "priority": "300",
                     "description": "Deny Rule for SQL injection",
                     "preview": false,
                     "expression": "evaluatePreconfiguredWaf('sqli-v33-stable', {'sensitivity': 1})"
                 },
                 "rule_xss": {
                     "action": "deny(403)",
                     "priority": "301",
                     "description": "Deny Rule for Cross Site Scripting",
                     "preview": false,
                     "expression": "evaluatePreconfiguredWaf('xss-v33-stable', {'sensitivity': 1})"
                 },
                 "rule_lfi": {
                     "action": "deny(403)",
                     "priority": "302",
                     "description": "Deny Rule for Local file inclusion",
                     "preview": false,
                     "expression": "evaluatePreconfiguredWaf('lfi-v33-stable', {'sensitivity': 1})"
                 },
                 "rule_rfi": {
                     "action": "deny(403)",
                     "priority": "303",
                     "description": "Deny Rule for Remote file inclusion",
                     "preview": false,
                     "expression": "evaluatePreconfiguredWaf('rfi-v33-stable', {'sensitivity': 1})"
                 },
                 "rule_methodenforcement": {
                     "action": "deny(403)",
                     "priority": "304",
                     "description": "Deny Rule for Method enforcement",
                     "preview": false,
                     "expression": "evaluatePreconfiguredWaf('methodenforcement-v33-stable', {'sensitivity': 1})"
                 },
                 "rule_scandetection": {
                     "action": "deny(403)",
                     "priority": "305",
                     "description": "Deny Rule for Scanner detection",
                     "preview": false,
                     "expression": "evaluatePreconfiguredWaf('scannerdetection-v33-stable', {'sensitivity': 1})"
                 },
                 "rule_protocolattack": {
                     "action": "deny(403)",
                     "priority": "306",
                     "description": "Deny Rule for Protocol Attack",
                     "preview": false,
                     "expression": "evaluatePreconfiguredWaf('protocolattack-v33-stable', {'sensitivity': 1})"
                 },
                 "rule_php": {
                     "action": "deny(403)",
                     "priority": "307",
                     "description": "Deny Rule for PHP Injection attack",
                     "preview": false,
                     "expression": "evaluatePreconfiguredWaf('php-v33-stable', {'sensitivity': 1})"
                 },
                 "rule_sessionfixation": {
                     "action": "deny(403)",
                     "priority": "308",
                     "description": "Deny Rule for Session Fixation",
                     "preview": false,
                     "expression": "evaluatePreconfiguredWaf('sessionfixation-v33-stable', {'sensitivity': 1})"
                 },
                 "rule_java": {
                     "action": "deny(403)",
                     "priority": "309",
                     "description": "Deny Rule for java attack",
                     "preview": false,
                     "expression": "evaluatePreconfiguredWaf('java-v33-stable', {'sensitivity': 1})"
                 },
                 "rule_nodejs": {
                     "action": "deny(403)",
                     "priority": "310",
                     "description": "Deny Rule for Nodejs attack",
                     "preview": false,
                     "expression": "evaluatePreconfiguredWaf('nodejs-v33-stable', {'sensitivity': 1})"
                 }
             },
             "security_policy_cves_and_vulnerabilities_rules": {
                "rule_apache_log4j": {
                     "action": "deny(403)",
                     "priority": "311",
                     "description": "Apache Log4j CVE-2021-44228",
                     "preview": false,
                     "expression": "evaluatePreconfiguredWaf('cve-canary', {'sensitivity': 1})"
                },
                "rule_json_sqli": {
                    "action": "deny(403)",
                    "priority": "312",
                    "description": "JSON-formatted content SQLi",
                    "preview": false,
                    "expression": "evaluatePreconfiguredWaf('json-sqli-canary', {'sensitivity': 1})"
                }
             }
         }
     ]
 }
 